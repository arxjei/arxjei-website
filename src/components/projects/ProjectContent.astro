---
import CustomBrutalButton from "@components/CustomBrutalButton.astro";
import CustomBrutalCard from "@components/CustomBrutalCard.astro";
import CustomBrutalPill from "@components/CustomBrutalPill.astro";
import { ExternalLink, MoveLeft, ReplyAll } from "lucide-astro";

interface Props {
	pubDate: Date;
	author: string;
	viewLiveDemoLink?: string;
	developerNotes?: string;
	draft?: boolean;
	tags: string[];
}

const { pubDate, author, viewLiveDemoLink, developerNotes, tags, draft } =
	Astro.props;
const { default: techStack } = await import("@data/misc/tech-stack.json");
---

<article
	class="poppins lg:border-l-2 lg:border-b-2 border-black col-span-4 px-6 md:px-12 py-8 md:py-12">
	<div class="max-w-3xl">
		<CustomBrutalButton
			href={`/projects`}
			class="!flex items-center gap-2 mb-6 md:mb-8 w-max">
			<MoveLeft
				size={18}
				strokeWidth={2.5}
			/>
			Back to projects
		</CustomBrutalButton>

		<div
			class="flex flex-wrap items-center gap-2 text-sm text-gray-600 mb-8 md:mb-12 pb-6 md:pb-8 border-b-2 border-gray-200">
			<div class="font-medium">
				{
					pubDate.toLocaleDateString("en-US", {
						year: "numeric",
						month: "long",
						day: "numeric",
						timeZone: "Asia/Manila",
						hour12: true,
						hour: "numeric",
						minute: "numeric",
						timeZoneName: "long",
					})
				}
			</div>
			<span class="text-black">•</span>
			<span>by <span class="font-medium">{author}</span></span>
			<span class="text-black">•</span>
			{draft && <span class="font-medium">Save as Draft</span>}
		</div>

		{
			developerNotes && (
				<CustomBrutalCard class="border-2 border-black !bg-lime-400">
					<h2 class="text-2xl font-bold mb-4">⚠️ Developer Notes</h2>
					<p class="italic">{developerNotes}</p>
				</CustomBrutalCard>
			)
		}

		<div class="prose max-w-none mb-12">
			<slot />
		</div>

		<div class="flex justify-between items-center">
			<ul class="flex flex-wrap gap-4 mt-2">
				{
					tags.map((tag) => {
						return (
							<li>
								<a
									class="sanchez"
									href={`/projects/tags/${tag.toLowerCase()}/`}>
									{(() => {
										const tech = techStack.find((t) => t.id === tag);
										return tech ? (
											<CustomBrutalPill
												color={tech.color}
												class="flex justify-center items-center gap-2">
												<i class={tech.logo} />
												{tech.name}
											</CustomBrutalPill>
										) : (
											<CustomBrutalPill class="poppins">{tag}</CustomBrutalPill>
										);
									})()}
								</a>
							</li>
						);
					})
				}
			</ul>
		</div>

		<div class="mt-12 pt-8 border-t-2 border-gray-200">
			<p class="text-sm font-semibold text-gray-700 mb-4">
				Interested in this project?
			</p>
			<div class="flex flex-wrap gap-4">
				<CustomBrutalButton
					href="/#contact-me"
					class="!flex items-center gap-2 !bg-lime-400">
					<ReplyAll
						size={18}
						strokeWidth={2.5}
					/>
					Contact Me
				</CustomBrutalButton>
				{
					viewLiveDemoLink && (
						<CustomBrutalButton
							href={viewLiveDemoLink}
							target="_blank"
							class="!flex items-center gap-2 !bg-lime-400">
							Live Demo
							<ExternalLink
								size={18}
								strokeWidth={2.5}
							/>
						</CustomBrutalButton>
					)
				}
			</div>
		</div>
	</div>
</article>
