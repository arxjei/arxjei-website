---
import CustomBrutalCard from "@components/CustomBrutalCard.astro";
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import CustomBrutalButton from "@components/CustomBrutalButton.astro";
import CustomBrutalPill from "@components/CustomBrutalPill.astro";

interface Props {
	project: CollectionEntry<"projects">;
}

const { project } = Astro.props;
const { default: techStack } = await import("@data/misc/tech-stack.json");
---

<div
	class="w-full sm:w-[calc(50%-1rem)] lg:w-[calc(33.333%-1.334rem)] xl:w-[calc(25%-1.5rem)]">
</div>

<CustomBrutalCard class="border-2 border-black">
	<h3 class="poppins text-lg md:text-xl">
		{project.data.title}
	</h3>
	<div class="border-3 border-black my-4 h-56">
		<Image
			src={project.data.imgUrl}
			alt={project.data.title}
			width={800}
			height={400}
			class="rounded h-full w-full object-cover"
		/>
	</div>
	<p class="poppins">{project.data.description}</p>
	<div class="flex justify-end my-4">
		<CustomBrutalButton href={`/projects/${project.id}/`}>
			Read more &rarr;
		</CustomBrutalButton>
	</div>

	<div class="hidden sm:inline-block">
		<p class="poppins t-2">tags:</p>
		<div class="flex justify-between items-center">
			<ul class="flex flex-wrap gap-4 mt-2">
				{
					project.data.tags.map((tag) => {
						return (
							<li>
								<a
									class="sanchez"
									href={`/projects/tags/${tag.toLowerCase()}/`}>
									{(() => {
										const tech = techStack.find((t) => t.id === tag);
										return tech ? (
											<CustomBrutalPill
												color={tech.color}
												class="flex justify-center items-center gap-2">
												<i class={tech.logo} />
												{tech.name}
											</CustomBrutalPill>
										) : (
											<CustomBrutalPill class="poppins">{tag}</CustomBrutalPill>
										);
									})()}
								</a>
							</li>
						);
					})
				}
			</ul>
			{
				project.data.draft && (
					<span class="bg-green rounded-full border-2 py-1 px-4 text-sm border-black card-shadow">
						Draft
					</span>
				)
			}
		</div>
	</div>
</CustomBrutalCard>
